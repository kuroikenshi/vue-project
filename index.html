<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <!-- <meta name="viewport" content="width=device-width,initial-scale=1.0"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui, viewport-fit=cover">
    <title>vue-project</title>

    <!-- WeUI -->
    <link rel="stylesheet" href="node_modules/weui/style/weui.min.css"/>
    <link rel="stylesheet" href="static/vendor/jquery-weui/css/jquery-weui.css"/>
    
    <!-- PhotoSwipe -->
    <!-- <link rel="stylesheet" href="static/vendor/PhotoSwipe-4.1.3/photoswipe.css">
    <link rel="stylesheet" href="static/vendor/PhotoSwipe-4.1.3/default-skin/default-skin.css"> -->
  </head>
  <body>
    <div id="app"></div>
    <!-- built files will be auto injected -->
    
    
    <div class="weui-mask" id="iosMask" style="display: none"></div>
    <div class="weui-actionsheet" id="iosActionsheet">
      <!-- <div class="weui-actionsheet__title">
         <p class="weui-actionsheet__title-text">这是一个标题，可以为一行或者两行。</p>
      </div> -->
      <!-- <div class="toolbar">
        <div class="toolbar-inner">
          <a href="javascript:;" class="picker-button close-picker">完成</a>
          <input type="text" class="title" id="commentInput2" >
        </div>
      </div> -->
      <div class="commentbar">
        <form>
          <input type="text" class="commentbar-input" id="commentInput" >
          <a href="javascript:;" class="comment-button disabled" id="commentSubmit">提交</a>
        </form>
      </div>
      <!-- <div class="weui-actionsheet__menu">
        <div class="weui-actionsheet__cell">示例菜单</div>
        <div class="weui-actionsheet__cell">示例菜单</div>
        <div class="weui-actionsheet__cell">示例菜单</div>
        <div class="weui-actionsheet__cell">示例菜单</div>
      </div> -->
      <!-- <div class="weui-actionsheet__action">
        <div class="weui-actionsheet__cell" id="iosActionsheetCancel">取消</div>
      </div> -->
   </div>
      
    <!-- <button id="showIOSActionSheet">clickme</button> -->

    <!-- 使用 -->
    <!-- <div class="page__bd page__bd_spacing">
       <a href="javascript:;" class="weui-btn weui-btn_primary">绿色按钮</a>
    </div> -->
    
    <script src="static/vendor/jquery/jquery.min.js"></script>
    <script src="static/vendor/jquery-weui/js/jquery-weui.js"></script>
    <script src="static/vendor/jquery-weui/js/swiper.js"></script>
    
    <!-- PhotoSwipe -->
    <!-- <script type="text/javascript" src="static/vendor/PhotoSwipe-4.1.3/photoswipe.min.js"></script>
    <script type="text/javascript" src="static/vendor/PhotoSwipe-4.1.3/photoswipe-ui-default.min.js"></script> -->
    
    <script>
      // TODO: 替换成原生js
      // 给点赞按钮加特效(玩)
      $('body').on('touchstart', '.act-button', function () {
        console.log(this, this.classList, this.classList.add);
        this.classList.add('active');
        
        $(this).on('touchend', function () {
          this.classList.remove('active');
        });
      });
      
      // 底部输入框示例-TODEL
      $(function(){
        var $iosActionsheet = $('#iosActionsheet');
        var $iosMask = $('#iosMask');
        /* 
        $('#iosActionsheetCancel').on('click', hideActionSheet);
        $("#showIOSActionSheet").on("click", function(){
          $iosActionsheet.addClass('weui-actionsheet_toggle');
          $iosMask.fadeIn(200);
        }); */
    
        // 给遮罩加点击事件
        function hideActionSheet() {
          $iosActionsheet.removeClass('weui-actionsheet_toggle');
          $iosMask.fadeOut(200);
        }
        $iosMask.on('click', hideActionSheet);
    
        // 提交按钮加禁用
        var $input = $('#commentInput')
        $input.on('input', function () {
          if ($(this).val().length == 0) {
            $('#commentSubmit').addClass('disabled')
          } else {
            $('#commentSubmit').removeClass('disabled')
          }
        })
      });
      
      // ios软键盘收回后向 页面向下滑动500px
      document.body.addEventListener('focusout', function () {
          window.scrollTo(0, 500);
      });
      
      // 给String扩展按照urlParam方式获取key的value的方法 => 使用window.vue.$qs.parse替换
      /* String.prototype.getUrlParam = function (key) {
        var reg = new RegExp("(^|&)" + key + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
        var r = this.match(reg);  //匹配目标参数
        if (r != null) return decodeURI(r[2]); return null; //返回参数值
      } */
      
      /*window.onload = function(){
        if (document.documentElement.scrollHeight <= document.documentElement.clientHeight) {
          bodyTag = document.getElementsByTagName('body')[0];
          bodyTag.style.height = document.documentElement.clientWidth / screen.width * screen.height + 'px';
        }
        setTimeout(function () {
          window.scrollTo(0, 1)
        }, 0);
      };*/
      
//       window.imgsWH = {}
//       
//       function getWHs(urlList) {
//         for (let i in urlList) {
//           getWH(urlList[i])
//         }
//       }
//       
//       function getWH(url) {
//         if (window.imgsWH[url] === undefined) {
//           let img = new Image()
//           img.onload = function() {
//             console.log(this, this.width, this.height)
//             window.imgsWH[url] = [this.width, this.height]
//           }
//           img.src = url
//         }
//       }
//       

      // 代码段A == START ==
      /* function setGesture(el) {
        var obj = {}; //定义一个对象
        var istouch = false;
        var start = [];
        el.addEventListener("touchstart", function(e) {
          // e.preventDefault();
          // window.event.cacenlBubble = false
          if (e.touches.length >= 2) { //判断是否有两个点在屏幕上
            istouch = true;
            start = e.touches; //得到第一组两个点
            obj.gesturestart && obj.gesturestart.call(el); //执行gesturestart方法
            // alert('双指');
          }
          else {
            // alert('单指');
          }
        }, false);
        document.addEventListener("touchmove", function(e) {
          e.preventDefault();
          // window.event.cacenlBubble = false
          if (e.touches.length >= 2 && istouch) {
            var now = e.touches; //得到第二组两个点
            var scale = getDistance(now[0], now[1]) / getDistance(start[0], start[1]); //得到缩放比例，getDistance是勾股定理的一个方法
            var rotation = getAngle(now[0], now[1]) - getAngle(start[0], start[1]); //得到旋转角度，getAngle是得到夹角的一个方法
            e.scale = scale.toFixed(2);
            e.rotation = rotation.toFixed(2);
            obj.gesturemove && obj.gesturemove.call(el, e); //执行gesturemove方法
          };
        }, false);
        document.addEventListener("touchend", function(e) {
          // e.preventDefault();
          // window.event.cacenlBubble = false
          if (istouch) {
            istouch = false;
            obj.gestureend && obj.gestureend.call(el); //执行gestureend方法
          };
        }, false);
        return obj;
      };
      
      function getDistance(p1, p2) {
        var x = p2.pageX - p1.pageX,
          y = p2.pageY - p1.pageY;
        return Math.sqrt((x * x) + (y * y));
      };
      
      function getAngle(p1, p2) {
        var x = p1.pageX - p2.pageX,
          y = p1.pageY - p2.pageY;
        return Math.atan2(y, x) * 180 / Math.PI;
      }; */
      // 代码段A === END ===
    </script>
  </body>
</html>
